CREATE EXTENSION IF NOT EXISTS "uuid-ossp";


create table users (
	id_user UUID DEFAULT uuid_generate_v4() PRIMARY KEY,
	username VARCHAR(50) not null unique,
	email varchar(100) not null unique,
	avatar_url varchar(255)
);

create table issue (
	id_issue uuid default uuid_generate_v4() primary key,
	title varchar(200),
	description text,
	status varchar(100) not null, --"Nuevo, En progreso, Resuelto"
	priority_id varchar(100) not null, --"Alta, Media, Baja"
	created_by UUID references users(id_user) not null,
	assigned_to UUID references users(id_user),
	deadline date,
	created_at timestamp default now(),
	updated_at timestamp default now()
);

create table comments (
	id_comment UUID default uuid_generate_v4() primary key,
	issue_id UUID references issue(id_issue) not null,
	user_id UUID references users(id_user) not null,
	content text not null,
	created_at timestamp default now()
);

create table attachments(
	attachment_id UUID default uuid_generate_v4() primary key,
	issue_id UUID references issue(id_issue),
	file_url varchar(255) not null,
	filename varchar(100) not null,
	uploaded_at timestamp default now()
);

create table watchers (
	issue_id UUID references issue(id_issue),
	user_id UUID references users(id_user),
	primary key (issue_id, user_id)
);
